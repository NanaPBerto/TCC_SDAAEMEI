<div class="container cadastro-atividade py-4">
  <div class="cadastro-container">
    <div class="cadastro-card">
      <div class="cadastro-header">
        <h1>
          <i class="fas fa-music me-2"></i>
          {{#if atividade}}Editar Atividade{{else}}Cadastrar Nova Atividade{{/if}}
        </h1>
        <p class="subtitle">Preencha os dados da atividade musical</p>
      </div>

      <form action="/novaAtividade" method="POST" enctype="multipart/form-data" class="cadastro-form">
        <div class="row g-3 mb-4">
          <div class="col-md-8">
            <label for="tituloAtividade" class="form-label">Título da Atividade</label>
            <input type="text" class="form-control" id="tituloAtividade" name="nome" placeholder="Ex: Ritmo com Copos" required>
          </div>
          <div class="col-md-4">
            <label class="form-label">Tipo</label>
            <select class="form-select" name="tipoId" required>
              <option value="1">Linguagem</option>
              <option value="2">Números</option>
              <option value="3">Formas e Espaço</option>
              <option value="4">Fauna</option>
              <option value="5">Flora</option>
              <option value="6">Tempo e Clima</option>
              <option value="7">Desenvolvimento Motor</option>
              <option value="8">Cidadania e MeioAmbiente</option>
              <option value="9">Folclore e Cultura</option>
            </select>
          </div> 
        </div>
        <div class="row g-3 mb-4">
          <div class="col-md-6">
            <label for="descricaoAtividade" class="form-label">Descrição</label>
            <textarea class="form-control" id="descricaoAtividade" name="descricao" rows="3" required></textarea>
          </div>
          <div class="col-md-6">
            <label for="objetivoAtividade" class="form-label">Objetivo</label>
            <textarea class="form-control" id="objetivoAtividade" name="objetivo" rows="3" required></textarea>
          </div>
        </div>
        <div class="row g-3 mb-4">
          <div class="col-md-3">
            <label class="form-label">Classificação</label>
            <select class="form-select" name="indexao" required>
              <option value="1 a 2 anos">1 a 2 anos</option>
              <option value="2 a 3 anos">2 a 3 anos</option>
              <option value="3 a 4 anos" selected>3 a 4 anos</option>
              <option value="4 a 5 anos">4 a 5 anos</option>
              <option value="5 a 6 anos">5 a 6 anos</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">Duração</label>
            <select class="form-select" name="duracao" required>
              <option value="5-15 min">5-15 min</option>
              <option value="15-30 min">15-30 min</option>
              <option value="30+ min">30+ min</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">Integrantes</label>
            <select class="form-select" name="vagas" required>
              <option value="1-5">1-5</option>
              <option value="5-10">5-10</option>
              <option value="10-15">10-15</option>
              <option value="15-20">15-20</option>
              <option value="20-25">20-25</option>
              <option value="25-30">25-30</option>
              <option value="+30">+30</option>
            </select>
          </div>
          <div class="col-md-3">
            <label for="indicacaoAtividade" class="form-label">Indicação</label>
            <input type="text" class="form-control" id="indicacaoAtividade" name="indicacao" required>
          </div>
        </div>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label for="recursosAtividade" class="form-label">Recursos</label>
            <textarea class="form-control" id="recursosAtividade" name="recursos" rows="2" required></textarea>
          </div>
          <div class="col-md-4">
            <label for="condicoesAtividade" class="form-label">Condições</label>
            <textarea class="form-control" id="condicoesAtividade" name="condicoes" rows="2" required></textarea>
          </div>
          <div class="col-md-4">
            <label for="obsAtividade" class="form-label">Observações</label>
            <textarea class="form-control" id="obsAtividade" name="obs" rows="2"></textarea>
          </div>
        </div>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Foto principal</label>
            <input type="file" class="form-control" name="imagem" accept="image/*">
          </div>
          <div class="col-md-4">
            <label class="form-label">Partitura</label>
            <input type="file" class="form-control" name="partitura" accept=".pdf,image/*">
          </div>
          <div class="col-md-4">
            <label class="form-label">Áudio</label>
            <input type="file" class="form-control" name="musica" accept="audio/*">
          </div>
        </div>
        <div class="d-flex justify-content-end gap-3 mt-4">
          <button type="submit" class="btn btn-outline-secondary px-4 py-2">
            <i class="fas fa-save me-2"></i>Salvar Atividade
          </button>
          <button type="reset" class="btn btn-outline-secondary px-4 py-2">
            <i class="fas fa-times-circle me-2"></i>Limpar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Debug do formulário
document.getElementById('formAtividade').addEventListener('submit', function(e) {
    console.log('Formulário sendo enviado...');
    
    // Mostrar dados do formulário
    const formData = new FormData(this);
    console.log('Dados do formulário:');
    for (let [key, value] of formData.entries()) {
        if (value instanceof File) {
            console.log(`${key}: ${value.name} (${value.size} bytes, ${value.type})`);
        } else {
            console.log(`${key}: ${value}`);
        }
    }
    
    // Mostrar loading
    const btn = document.getElementById('btnSubmit');
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Salvando...';
    btn.disabled = true;
});

// Mostrar nome dos arquivos selecionados
document.querySelectorAll('input[type="file"]').forEach(input => {
    input.addEventListener('change', function() {
        if (this.files[0]) {
            console.log('Arquivo selecionado:', this.files[0].name);
            const fileNameElement = this.parentElement.querySelector('span');
            if (fileNameElement) {
                fileNameElement.textContent = this.files[0].name;
                fileNameElement.className = 'd-block mt-2 text-success';
            }
        }
    });
});
</script>