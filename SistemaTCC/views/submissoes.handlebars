<div class="container">
  <div class="form-section" style="height: auto;">
    <h4 class="mb-4">
      <i class="bi bi-list-ul me-2" style="color: var(--primary);"></i>
      Minhas Submissões
    </h4>
    <ul class="nav nav-tabs mb-4">
      <li class="nav-item">
        <p></p>
      </li>
    </ul>
    {{#if atividades.length}}
      <p class="text-muted text-center">Você tem {{atividades.length}} submissões.</p>
    {{else}}
      <div class="text-center">
        <small>Você ainda não submeteu nenhuma atividade.</small>
      </div>
    {{/if}} 
    <br> 
    <div class="row justify-content-center">
      {{#each atividades}}
        <div class="col-12 col-md-6 col-lg-4 mb-4">
          <div class="card shadow-lg border-0 h-100 rounded-4">
            <div class="card-body d-flex flex-column align-items-center">
              <h5 class="card-title text-center mb-3" style="font-weight: bold; color: var(--primary);">{{nome}}</h5>
              {{#if imagemBase64}}
                <img src="data:{{imagemMime}};base64,{{imagemBase64}}" alt="Imagem da Atividade" class="img-fluid rounded-4 mb-3 shadow" style="max-height:180px; object-fit:cover;">
              {{/if}}
              <p class="card-text text-center mb-2" style="min-height: 60px;">{{descricao}}</p>
              <div class="btn-group mt-auto mb-2" role="group">
                <a href="/deletar/{{id}}" onclick="return confirm('Tem certeza que deseja excluir esta atividade?')">
                  <button id="btnSubmissões" type="button" class="btn btn-outline-danger px-3 py-2">Deletar</button>
                </a>
                <button id="btnSubmissões" type="button" class="btn btn-outline-primary px-3 py-2" data-bs-toggle="modal" data-bs-target="#ModalDetalhes{{id}}">
                  Detalhes
                </button>
                <a href="/editar/{{id}}">
                  <button id="btnSubmissões" type="button" class="btn btn-outline-success px-3 py-2">Editar</button>
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal único por submissão -->
        <div class="modal fade" id="ModalDetalhes{{id}}" tabindex="-1" aria-labelledby="ModalDetalhesLabel{{id}}" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content rounded-4">
              <div class="modal-header bg-primary text-white rounded-top-4">
                <h5 class="modal-title w-100 text-center" id="ModalDetalhesLabel{{id}}">
                  <i class="fas fa-music me-2"></i>Detalhes da Atividade: <b>{{nome}}</b>
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
              </div>
              <div class="modal-body">
                <div class="row g-4">
                  <div class="col-md-5 text-center">
                    {{#if imagemBase64}}
                      <img src="data:{{imagemMime}};base64,{{imagemBase64}}" alt="Imagem da Atividade" class="img-fluid rounded-4 shadow mb-3" style="max-height:220px; object-fit:cover;">
                    {{else}}
                      <div class="d-flex align-items-center justify-content-center bg-light rounded-4 mb-3" style="height: 180px;">
                        <i class="fas fa-music fa-3x text-secondary"></i>
                      </div>
                    {{/if}}
                  </div>
                  <div class="col-md-7">
                    <ul class="list-group list-group-flush mb-3">
                      <li class="list-group-item"><b>Descrição:</b> {{descricao}}</li>
                      <li class="list-group-item"><b>Objetivo:</b> {{objetivo}}</li>
                      <li class="list-group-item"><b>Indicação:</b> {{indicacao}}</li>
                      <li class="list-group-item"><b>Integrantes:</b> {{vagas}}</li>
                      <li class="list-group-item"><b>Duração:</b> {{duracao}}</li>
                      <li class="list-group-item"><b>Classificação:</b> {{classificacao}}</li>
                      <li class="list-group-item"><b>Tipo:</b> {{tipo.nome}}</li>
                      <li class="list-group-item"><b>Recursos:</b> {{recursos}}</li>
                      <li class="list-group-item"><b>Condições:</b> {{condicoes}}</li>
                      {{#if obs}}
                        <li class="list-group-item"><b>Observações:</b> {{obs}}</li>
                      {{/if}}
                    </ul>
                    {{#if partituraBase64}}
                      <div class="mb-2">
                        <span class="fw-bold"><i class="fas fa-file-alt me-2"></i>Partitura:</span>
                        <a href="{{partituraBase64}}" target="_blank" class="btn btn-outline-primary btn-sm ms-2">Visualizar Partitura</a>
                      </div>
                    {{/if}}
                    {{#if musicaBase64}}
                      <div class="mb-2">
                        <span class="fw-bold"><i class="fas fa-music me-2"></i>Áudio:</span>
                        <audio controls class="w-100 mt-2">
                          <source src="{{musicaBase64}}">
                          Seu navegador não suporta o elemento de áudio.
                        </audio>
                      </div>
                    {{/if}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</div>